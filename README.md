# TODO

> Discord Ã— Web ã®TODOç®¡ç†ãƒ„ãƒ¼ãƒ«

[![Node.js](https://img.shields.io/badge/Node.js-18%2B-339933?logo=node.js)](https://nodejs.org/)
[![Discord.js](https://img.shields.io/badge/Discord.js-v14-5865F2?logo=discord)](https://discord.js.org/)
[![License](https://img.shields.io/badge/License-ISC-blue)](LICENSE)

## æ¦‚è¦

Discordã‚µãƒ¼ãƒãƒ¼ã¨Webãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ä¸¡æ–¹ã‹ã‚‰ã‚¿ã‚¹ã‚¯ã‚’ç®¡ç†ã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚  
é™çš„ãƒ“ãƒ«ãƒ‰ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ãƒ›ã‚¹ãƒˆã™ã‚‹çµ±åˆå‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
git clone <repository-url> todo && cd todo
node setup.js
```

å¯¾è©±å½¢å¼ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã™ã€‚

---

## æ©Ÿèƒ½ä¸€è¦§

<details>
<summary><b>ğŸ“‹ ã‚¿ã‚¹ã‚¯ç®¡ç†</b></summary>

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| CRUD | ã‚¿ã‚¹ã‚¯ã®ä½œæˆãƒ»é–²è¦§ãƒ»ç·¨é›†ãƒ»å‰Šé™¤ |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | æœªç€æ‰‹ / é€²è¡Œä¸­ / ä¿ç•™ / å®Œäº† / ãã®ä»– |
| å„ªå…ˆåº¦ | ä½ / ä¸­ / é«˜ / ç·Šæ€¥ |
| æœŸé™ | æ—¥ä»˜æŒ‡å®š |
| ã‚³ãƒ¡ãƒ³ãƒˆ | ã‚¿ã‚¹ã‚¯ã¸ã®ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ  |
| è¤‡æ•°æ‹…å½“ | è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®åŒæ™‚å‰²ã‚Šå½“ã¦ |

</details>

<details>
<summary><b>ğŸ‘¥ ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†</b></summary>

- ã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤
- ãƒ¡ãƒ³ãƒãƒ¼ã®è¿½åŠ ãƒ»å‰Šé™¤
- ã‚°ãƒ«ãƒ¼ãƒ—å˜ä½ã§ã®ã‚¿ã‚¹ã‚¯å‰²ã‚Šå½“ã¦
- Discord ãƒ­ãƒ¼ãƒ«ã®è‡ªå‹•ä½œæˆãƒ»åŒæœŸ

</details>

<details>
<summary><b>ğŸ¤– Discord Bot</b></summary>

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|----------|------|
| `/todo panel` | ç®¡ç†ãƒ‘ãƒãƒ«è¡¨ç¤º |
| `/todo add` | ã‚¿ã‚¹ã‚¯è¿½åŠ  |
| `/todo list` | ã‚¿ã‚¹ã‚¯ä¸€è¦§ |
| `/todo view` | ã‚¿ã‚¹ã‚¯è©³ç´° |
| `/todo status` | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ |
| `/todo delete` | ã‚¿ã‚¹ã‚¯å‰Šé™¤ |
| `/todo stats` | çµ±è¨ˆè¡¨ç¤º |
| `/group create` | ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ |
| `/group list` | ã‚°ãƒ«ãƒ¼ãƒ—ä¸€è¦§ |
| `/group view` | ã‚°ãƒ«ãƒ¼ãƒ—è©³ç´° |
| `/group add-member` | ãƒ¡ãƒ³ãƒãƒ¼è¿½åŠ  |
| `/group remove-member` | ãƒ¡ãƒ³ãƒãƒ¼å‰Šé™¤ |
| `/group delete` | ã‚°ãƒ«ãƒ¼ãƒ—å‰Šé™¤ |
| `/ping` | Bot ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |

</details>

<details>
<summary><b>ğŸ” èªè¨¼ãƒ»æ¨©é™</b></summary>

- **Discord OAuth** â€” ã‚µãƒ¼ãƒãƒ¼ãƒ¡ãƒ³ãƒãƒ¼èªè¨¼
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼** â€” ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆ`.env` ã§æœ‰åŠ¹/ç„¡åŠ¹åˆ‡æ›¿ï¼‰
- **ãƒ­ãƒ¼ãƒ«æ¨©é™åˆ¶å¾¡** â€” ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆ / ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆæ–¹å¼ï¼ˆ`.env` ã§è¨­å®šï¼‰
- **ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹å¯¾ç­–** â€” 5å›å¤±æ•—ã§15åˆ†ãƒ­ãƒƒã‚¯
- **ãƒ¬ãƒ¼ãƒˆåˆ¶é™** â€” å…¨ä½“ 200req/minã€èªè¨¼ 20req/15min

</details>

<details>
<summary><b>ğŸ“¤ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</b></summary>

TXT / CSV / JSON å½¢å¼ã§ã‚¿ã‚¹ã‚¯ã‚’å‡ºåŠ›

</details>

---

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- **Node.js** v18+
- **npm** v9+

### 1. Discord Application ã®ä½œæˆ

1. [Discord Developer Portal](https://discord.com/developers/applications) ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
2. **Bot** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆã—ã€ä»¥ä¸‹ã® Intents ã‚’æœ‰åŠ¹åŒ–:
   - `SERVER MEMBERS INTENT`
   - `MESSAGE CONTENT INTENT`
3. **OAuth2** ã§ Client ID / Client Secret ã‚’å–å¾—
4. **Redirects** ã« `https://<YOUR_DOMAIN>/auth/callback` ã‚’è¿½åŠ 
5. Bot ã‚’ã‚µãƒ¼ãƒãƒ¼ã«æ‹›å¾…ï¼ˆã‚¹ã‚³ãƒ¼ãƒ—: `bot`, `applications.commands`ï¼‰

> [!TIP]
> ã‚µãƒ¼ãƒãƒ¼IDã®å–å¾—: Discord ã§é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ã€ã‚µãƒ¼ãƒãƒ¼å³ã‚¯ãƒªãƒƒã‚¯ â†’ ã€Œã‚µãƒ¼ãƒãƒ¼IDã‚’ã‚³ãƒ”ãƒ¼ã€

### 2. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Ÿè¡Œ

```bash
node setup.js
```

ä»¥ä¸‹ãŒå¯¾è©±å½¢å¼ã§è¨­å®šã•ã‚Œã¾ã™:

- `.env` ã®ä½œæˆï¼ˆDiscord è¨­å®šãƒ»èªè¨¼ãƒ»ãƒãƒ£ãƒ³ãƒãƒ«IDç­‰ï¼‰
- ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ“ãƒ«ãƒ‰
- Discord ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰ã®ç™»éŒ²
- pm2 ã§ã®èµ·å‹•

### 3. æ‰‹å‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆä»»æ„ï¼‰

<details>
<summary>æ‰‹å‹•ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹å ´åˆ</summary>

```bash
# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
cd backend && npm install && cd ../frontend && npm install && cd ..

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼
cp backend/.env.example backend/.env
cp ecosystem.config.js.example ecosystem.config.js
# â†’ backend/.env ã‚’ç·¨é›†

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰
cd frontend && npm run deploy && cd ..

# ã‚³ãƒãƒ³ãƒ‰ç™»éŒ²
cd backend && npm run deploy-commands && cd ..

# èµ·å‹•
pm2 start ecosystem.config.js
```

</details>

---

## ç’°å¢ƒå¤‰æ•°

> [!IMPORTANT]
> `backend/.env` ã«è¨­å®šã—ã¦ãã ã•ã„ã€‚`.env.example` ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ç”¨ã§ãã¾ã™ã€‚

| å¤‰æ•° | å¿…é ˆ | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
|------|:----:|------|-----------|
| `DISCORD_TOKEN` | âœ… | Bot ãƒˆãƒ¼ã‚¯ãƒ³ | â€” |
| `DISCORD_CLIENT_ID` | âœ… | OAuth2 Client ID | â€” |
| `DISCORD_CLIENT_SECRET` | âœ… | OAuth2 Client Secret | â€” |
| `DISCORD_GUILD_ID` | âœ… | å¯¾è±¡ã‚µãƒ¼ãƒãƒ¼ID | â€” |
| `PORT` | â€” | ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒˆ | `4040` |
| `BASE_URL` | â€” | å…¬é–‹URL | `http://localhost:4040` |
| `SESSION_SECRET` | âœ… | ã‚»ãƒƒã‚·ãƒ§ãƒ³æš—å·åŒ–ã‚­ãƒ¼ | â€” |
| `ADMIN_PASSWORD` | â€” | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ç”¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ | â€” |
| `ENABLE_PASSWORD_LOGIN` | â€” | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ã®æœ‰åŠ¹/ç„¡åŠ¹ | `false` |
| `PANEL_CHANNEL_ID` | â€” | ãƒ‘ãƒãƒ«è‡ªå‹•é€ä¿¡ãƒãƒ£ãƒ³ãƒãƒ« | â€” |
| `NOTIFY_CHANNEL_ID` | â€” | é€šçŸ¥ãƒãƒ£ãƒ³ãƒãƒ« | â€” |
| `PERMISSION_MODE` | â€” | æ¨©é™ãƒ¢ãƒ¼ãƒ‰ï¼ˆ`white` / `black` / `disable`ï¼‰ | `disable` |
| `PERMISSION_ROLE_ID` | â€” | å¯¾è±¡ãƒ­ãƒ¼ãƒ«ID | â€” |

> [!NOTE]
> **æ¨©é™ãƒ¢ãƒ¼ãƒ‰** ã«ã¤ã„ã¦:
> - `disable` â€” åˆ¶é™ãªã—ï¼ˆã‚µãƒ¼ãƒãƒ¼ãƒ¡ãƒ³ãƒãƒ¼ãªã‚‰å…¨å“¡åˆ©ç”¨å¯ï¼‰
> - `white` â€” æŒ‡å®šãƒ­ãƒ¼ãƒ«ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼**ã®ã¿**åˆ©ç”¨å¯
> - `black` â€” æŒ‡å®šãƒ­ãƒ¼ãƒ«ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯åˆ©ç”¨**ä¸å¯**

---

## Nginx & SSLï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰

<details>
<summary>Nginx è¨­å®šä¾‹</summary>

```nginx
server {
    listen 80;
    server_name todo.example.com;

    location / {
        proxy_pass http://127.0.0.1:4040;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

```bash
# sites-available ã«ä¿å­˜å¾Œã€sites-enabled ã«ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯
sudo ln -s /etc/nginx/sites-available/todo.example.com /etc/nginx/sites-enabled/
sudo nginx -t && sudo systemctl reload nginx

# SSL è¨¼æ˜æ›¸å–å¾—ï¼ˆNginxè¨­å®šã¯è‡ªå‹•ã§æ›´æ–°ã•ã‚Œã¾ã™ï¼‰
sudo certbot --nginx -d todo.example.com
```

</details>

---

## pm2 ã‚³ãƒãƒ³ãƒ‰

```bash
pm2 start ecosystem.config.js   # èµ·å‹•
pm2 restart todo         # å†èµ·å‹•
pm2 logs todo            # ãƒ­ã‚°ç¢ºèª
pm2 stop todo            # åœæ­¢
```

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ |
|----------|------|
| Backend | Node.js, Express, Discord.js v14 |
| Database | SQLite (better-sqlite3, WAL) |
| Frontend | Astro (é™çš„å‡ºåŠ›), Svelte 5, TypeScript |
| Process | pm2 |

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

[ISC](LICENSE)
